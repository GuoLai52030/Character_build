<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>æ•°å€¼è†¨èƒ€ç”Ÿå­˜æ¨¡æ‹Ÿå™¨</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: sans-serif; background: #121212; color: #fff; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: #1e1e1e; padding: 25px; border-radius: 15px; border: 1px solid #333; }
        .header { border-bottom: 2px solid #444; margin-bottom: 20px; padding-bottom: 10px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .control-panel { background: #252525; padding: 20px; border-radius: 12px; }
        .display-panel { background: #000; padding: 20px; border-radius: 12px; border-left: 6px solid #ff5252; }
        input[type=range] { width: 100%; margin: 12px 0; accent-color: #00e5ff; }
        .stat-line { display: flex; justify-content: space-between; margin-bottom: 8px; font-family: monospace; }
        .value { color: #00e5ff; font-weight: bold; }
        .warning { color: #ff5252; }
        .success { color: #00ff88; border-left-color: #00ff88 !important; }
        canvas { margin-top: 20px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h2>ğŸŒ™ è¡€æœˆæ•°å€¼è†¨èƒ€æ¨¡æ‹Ÿå™¨ (è¯ç¼€ç´¯åŠ æ¨¡å‹)</h2>
    </div>

    <div class="grid">
        <div class="control-panel">
            <label>è¡€æœˆç­‰çº§ (L): <span id="lText" class="value">0</span></label>
            <input type="range" id="lSlider" min="0" max="300" value="0">

            <label>æ€ªç‰©æ•°é‡ (N): <span id="nText" class="value">1</span></label>
            <input type="range" id="nSlider" min="1" max="50" value="1">

            <label>è¯ç¼€å¢ä¼¤ç´¯è®¡ (%): <span id="bonusText" class="value">0</span></label>
            <input type="range" id="bonusSlider" min="0" max="800" value="0" step="10">
            
            <p style="font-size: 0.8em; color: #888;">* åˆå§‹æ”»å‡»: 122 | å±€å¤–åŸºç¡€: 30 | æ»¡è¯ç¼€: 800%</p>
        </div>

        <div id="statusBox" class="display-panel">
            <div class="stat-line">å±€å†…æ€»æ”»å‡»åŠ›: <span id="atkInText">---</span></div>
            <div class="stat-line">æš´å‡»ä¼¤å®³: <span id="critText">---</span></div>
            <div class="stat-line">ç”Ÿå­˜å€’è®¡æ—¶: <span id="timeText">---</span></div>
            <hr style="border:0; border-top:1px solid #333;">
            <div id="resultText" style="font-size: 1.4em; font-weight: bold; margin-top: 10px;">è®¡ç®—ä¸­...</div>
            <div style="font-size: 0.85em; margin-top: 5px; opacity: 0.7;">å»ºè®®è¯ç¼€å¢ä¼¤è‡³å°‘éœ€: <span id="reqBonus">---</span>%</div>
        </div>
    </div>

    <canvas id="growthChart" height="120"></canvas>
</div>

<script>
    const lS = document.getElementById('lSlider');
    const nS = document.getElementById('nSlider');
    const bS = document.getElementById('bonusSlider');
    const ctx = document.getElementById('growthChart').getContext('2d');

    function getMonsterHP(L) {
        if (L <= 100) return 3703 + 24.57 * L;
        if (L <= 200) return 6160 + 262.68 * (L - 100);
        return 32428 + 383.48 * (L - 200);
    }

    const chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: Array.from({length: 31}, (_, i) => i * 10),
            datasets: [{
                label: 'æ‰€éœ€æ”»å‡»åŠ› (æ— é™è†¨èƒ€)',
                data: [],
                borderColor: '#00e5ff',
                borderWidth: 2,
                pointRadius: 0,
                fill: true,
                backgroundColor: 'rgba(0, 229, 255, 0.1)'
            }]
        },
        options: {
            scales: { y: { type: 'logarithmic', grid: { color: '#333' } }, x: { grid: { display: false } } },
            plugins: { legend: { display: false } }
        }
    });

    function update() {
        const L = parseInt(lS.value);
        const N = parseInt(nS.value);
        const bonus = parseInt(bS.value) / 100;
        
        // æ ¸å¿ƒå…¬å¼å®ç°
        const atkOut = 30;
        const atkInit = 122;
        const atkIn = atkOut + (atkInit - atkOut) * (1 + bonus);
        const critDmg = 2 * atkIn - atkOut;
        
        const mHP = getMonsterHP(L);
        const totalMHP = mHP * N;
        const timeToDie = 100 / (N * 30);
        
        // å­˜æ´»åˆ¤å®š (å‡è®¾æ”»å‡»é¢‘ç‡ä¸º1ï¼Œæ­¤å¤„å¯¹æ¯”å•æ¬¡æ”»å‡»å¼ºåº¦)
        const isSafe = (atkIn * 1) >= (totalMHP / timeToDie); 

        // æ›´æ–°UI
        document.getElementById('lText').innerText = L;
        document.getElementById('nText').innerText = N;
        document.getElementById('bonusText').innerText = (bonus * 100).toFixed(0);
        document.getElementById('atkInText').innerText = Math.floor(atkIn).toLocaleString();
        document.getElementById('critText').innerText = Math.floor(critDmg).toLocaleString();
        document.getElementById('timeText').innerText = timeToDie.toFixed(2) + "s";
        
        // é€†æ¨æ‰€éœ€è¯ç¼€
        const reqAtk = totalMHP / timeToDie;
        const reqBonusVal = ((reqAtk - atkOut) / (atkInit - atkOut) - 1) * 100;
        document.getElementById('reqBonus').innerText = reqBonusVal > 0 ? Math.ceil(reqBonusVal).toLocaleString() : "0";

        const box = document.getElementById('statusBox');
        const res = document.getElementById('resultText');
        if (isSafe) {
            box.className = "display-panel success";
            res.innerText = "æ•°å€¼å‹åˆ¶æˆåŠŸ âœ…";
        } else {
            box.className = "display-panel";
            res.innerText = "æ•°å€¼ä¸è¶³ï¼Œæ— æ³•ç”Ÿå­˜ âŒ";
        }

        // æ›´æ–°å›¾è¡¨è¶‹åŠ¿
        chart.data.datasets[0].data = Array.from({length: 31}, (_, i) => {
            const tempL = i * 10;
            return (getMonsterHP(tempL) * N) / timeToDie;
        });
        chart.update('none');
    }

    [lS, nS, bS].forEach(s => s.addEventListener('input', update));
    update();
</script>
</body>
</html>

